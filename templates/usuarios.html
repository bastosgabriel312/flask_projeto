{% include 'navbar.html' %}


<body class="back">
<!------------------- TABELA DE LOGINS ------------------->
 

	<div class="container">
		<button type="button" class="btn btn-dark" data-toggle="modal" data-target="#exampleModal" style="margin-bottom: 1%;">Editar usuários</button>
	<table class="table table-striped table-dark">
	  <thead>
	      <th scope="col">ID</th>
	      <th scope="col">NOME</th>
	      <th scope="col">EMAIL</th>
	      <th scope="col">USUARIO</th>
	      <th scope="col">SENHA</th>
	    </tr>

	  </thead>
	  <tbody>
			<!-------- Dinamica (loop) para visualização dos usuários -------->
			{%block content%}
			    {% for usuario in usuarios %}
					  <tr>
					  	<td>{{ usuario[0] }}</td>
					    <td>{{ usuario[1] }}</td>
					    <td>{{ usuario[2] }}</td>
					    <td>{{ usuario[3] }}</td>
					    <td>{{ usuario[4] }}</td>

			    </div>
		 	</div>
		</div>

		{% endfor %}
	{%endblock%}


			<!-------- Dinamica (loop) para visualização dos usuários/end -------->
	  </tbody>
	</table>
	</div>


	<!-- Large modal -->
<div class="modal" tabindex="-1" role="dialog" id="exampleModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Usuário</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        

<!------------------- FORMULÁRIO DE EDIÇÃO DE USUARIO ------------------->
	<div class="container">
		<form action="/usuarios" method="POST">
			<!------------------- OPTIONS - EDIÇÃO DE USUARIO ------------------->
			<div class="form-group">
	  			<div class="input-group mb-3">
				  	<div class="input-group-prepend">
				    	<label class="input-group-text" for="inputGroupSelect01">Usuário</label>
				  	</div>
				  	<select class="custom-select" id="inputGroupSelect01" name = "option_user">
				    	<option value =""  selected>Escolha um usuário...</option>
				    	{% for teste in usuarios %}
				    		<option value="{{teste[0]}}"  id ="option_user">{{teste[1]}}</option>
				    	{% endfor%}
				 	</select>
				</div>
			</div>
			<!------------------- OPTIONS - EDIÇÃO DE USUARIO ------------------->


		  	<div class="form-group">
		    	<label class="label-form" >Nome:</label>
		    	<input type="text" class="form-control" id="nome_atual" name="nome_atual" placeholder="Nome">
		  	</div>
		  	<div class="form-group">
		    	<label class="label-form" >E-mail:</label>
		    	<input type="email" class="form-control" id="email_atual" name="email_atual" placeholder="Senha">
		  	</div>
		  	<div class="form-group">
		    	<label class="label-form" >Usuário:</label>
		  		<input type="text" class="form-control" id="usuario_atual" name="usuario_atual" placeholder="Usuário">
		  	</div>
		  	<div class="form-group">
		    	<label class="label-form" >Senha:</label>
		    	<input type="text" class="form-control" id="senha_atual" name="senha_atual" placeholder="Senha antiga">
		    	<small>Até 9 caracteres</small>
		  	</div>
		  	<div class="form-group">
		    	<label class="label-form" >Confirmar senha:</label>
				<input type="text" class="form-control" id="confirmar_senha" name="confirmar_senha" placeholder="Alterar Senha">
		 	</div>
		 	<h5>Dados a Atualizar:</h5>
		 	<div class="row">
			    <div class="col">
			    	<div class="form-group">
						<div class="form-check">
				  				<input class="form-check-input" type="checkbox" value="True" id="update_nome" name="update_nome">
				  				<label class="form-check-label" for="update_nome">
				    				Nome
				  				</label>
						</div>
						<div class="form-check">
				 				<input class="form-check-input" type="checkbox" value="True" id="update_email" name="update_email">
				  				<label class="form-check-label" for="update_email">
				    				E-mail
				  				</label>
						</div>
					</div>
			    </div>
			    <div class="col">
			    	<div class="form-group">
						<div class="form-check">
				  				<input class="form-check-input" type="checkbox" value="True" id="update_usuario" name="update_usuario">
				  				<label class="form-check-label" for="update_usuario">
				    				Usuário
				  				</label>
						</div>
						<div class="form-check">
				 				<input class="form-check-input" type="checkbox" value="True" id="update_senha" name="update_senha">
				  				<label class="form-check-label" for="update_senha">
				    				Senha
				  				</label>

						</div>

					</div>
				</div>
			</div>
			<hr>
								<div class="form-check">
				 				<input class="form-check-input is-invalid" type="checkbox" value="True" id="delete_usuario" name="delete_usuario">	
				  				<label class="form-check-label" for="delete_usuario">
				    				Excluir Usuário - 
				  		
				  				<strong>Atenção operação irreversível</strong></label>
						</div>
	</div>

<!------------------- FORMULÁRIO DE EDIÇÃO DE USUARIO/end ------------------->





      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" onclick="validar()">Enviar</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
      </form>
    </div>
  </div>
</div>






<!------------------- TABELA DE LOGINS/end ------------------->




<!------------------- SCRIPT PARA VALIDAÇÃO DE CAMPOS DE USUARIOS ------------------->
<script type="text/javascript">
/* Função Validar */
function validar() {
  // pegando o valor do nome pelos names
  var id = document.getElementById("option_user")
  var nome = document.getElementById("nome_atual");
  var email = document.getElementById("email_atual");
  var usuario = document.getElementById("usuario_atual");
  var senha = document.getElementById("password");
  var senha_confirmar = document.getElementById("password-confirm");
  var nivel = document.getElementById("nivel");
  var update_nome = document.getElementById("update_nome")
  var update_email = document.getElementById("update_email")
  var update_usuario = document.getElementById("update_usuario")
  var update_senha = document.getElementById("update_senha")
  var delete_usuario = document.getElementById("delete_usuario")




  // verificar delete usuário
	if (delete_usuario.checked) {
	  let confirmar = confirm("Tem certeza?")
	  if (confirmar==true) {
	  	alert("Usuário deletado!!!");
	  }
	  else{
	  	alert("Operação cancelada!");
	  	return;
	  }

	}

  // verificar se o nome está vazio
	if (update_nome.checked) {
	  if (nome.value == "") {
	    alert("Nome não informado, valores não atualizados.");
	    // retorna a função e não olha as outras linhas
	    return;
	  }

	}
	// verificar se o nome está vazio
	if (update_usuario.checked) {
	  if (usuario.value == "") {
	    alert("Usuário não informado, valores não atualizados.");
	    // retorna a função e não olha as outras linhas
	    return;
	  }

	}
  // verificar se o email está vazio
  	if (update_email.checked){
	  if (email.value == "") {
	    alert("E-mail não informado, valores não atualizados.");
	    // retorna a função e não olha as outras linhas
	    return;
	  }

	}

  // verificar se a senha está vazia
	if (update_senha.checked) {
	  if (senha.value == "") {
	    alert("Senha não informada, valores não atualizados.");
	    // retorna a função e não olha as outras linhas
	    return;
	  }

	}

  // verificar se a senha-confirmar está vazia
  	if (update_senha.checked) {
	  if (senha_confirmar.value == "") {
	    alert("Confirmação de senha não informada, valores não atualizados.");
	    // retorna a função e não olha as outras linhas
	    return;
	  }

	}

  // Verifica se a senha é diferente da senha confirmar
  	if (update_senha.checked) {
	  if (senha_confirmar.value != senha.value) {
	    alert("As senhas informadas não coincidem, valores não atualizados.");
	    // retorna a função e não olha as outras linhas
	    return;
	  }

	}

  alert("Dados atualizados");
  // envia o formulário
  window.location.href = "/usuarios";
}



</script>

<!------------------- JAVASCRIPT BOOTSTRAP ------------------->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<!------------------- JAVASCRIPT BOOTSTRAP/end ------------------->
</body>
</html>